{"version":3,"sources":["../../../src/routes/routines.js"],"names":["application","route","post","req","res","global","conn","collection","err","update","_id","mongodb","ObjectId","params","idUser","$push","routines","id_routine","title","body","steps","status","json","get","find","toArray","docs","error"],"mappings":";;;;;;kBAEe,UAASA,WAAT,EAAqB;;AAEhC;AACAA,gBAAYC,KAAZ,CAAkB,wBAAlB,EAA4CC,IAA5C,CAAiD,UAACC,GAAD,EAAMC,GAAN,EAAc;AAC3DC,eAAOC,IAAP,CAAYC,UAAZ,CAAuB,OAAvB,EAAgC,UAACC,GAAD,EAAMD,UAAN,EAAqB;AACjDA,uBAAWE,MAAX,CACI,EAAEC,KAAKC,kBAAQC,QAAR,CAAiBT,IAAIU,MAAJ,CAAWC,MAA5B,CAAP,EADJ,EAEI,EAACC,OAAQ;AACDC,8BAAU;AACNC,oCAAY,IAAIN,kBAAQC,QAAZ,EADN;AAENM,+BAAOf,IAAIgB,IAAJ,CAASD,KAFV;AAGNE,+BAAOjB,IAAIgB,IAAJ,CAASC;AAHV;;AADT;AAAT,aAFJ,EAWI,EAXJ,EAYI,UAACZ,GAAD,EAAS;AACL,oBAAGA,GAAH,EAAQ;AACJJ,wBAAIiB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAC,SAASd,GAAV,EAArB;AACH,iBAFD,MAEO;AACHJ,wBAAIiB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAC,UAAU,8BAAX,EAArB;AACH;AAEJ,aAnBL;AAqBA,gBAAGd,GAAH,EAAO;AACHJ,oBAAIiB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAC,SAASd,GAAV,EAArB;AACH;AACJ,SAzBD;AA4BH,KA7BD;AA8BA;AACAR,gBAAYC,KAAZ,CAAkB,wBAAlB,EAA4CsB,GAA5C,CAAgD,UAACpB,GAAD,EAAMC,GAAN,EAAc;AAC1DC,eAAOC,IAAP,CAAYC,UAAZ,CAAuB,OAAvB,EAAgCiB,IAAhC,CACIb,kBAAQC,QAAR,CAAiBT,IAAIU,MAAJ,CAAWC,MAA5B,CADJ,EAEEW,OAFF,CAGI,UAACjB,GAAD,EAAMkB,IAAN,EAAe;AACX,gBAAIV,WAAWU,KAAKV,QAApB;AACA,gBAAIR,GAAJ,EAAS;AACLJ,oBAAIiB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEK,OAAOnB,GAAT,EAArB;AACH,aAFD,MAEO;AACHJ,oBAAIiB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAC,QAAQI,IAAT,EAArB;AACH;AAEJ,SAXL;AAaH,KAdD;AAgBH,C;;AApDD","file":"routines.js","sourcesContent":["import mongodb from 'mongodb';\r\n\r\nexport default function(application){\r\n\r\n    //Usuario envia Rotina\r\n    application.route('/user/:idUser/routines').post((req, res) => {\r\n        global.conn.collection('users', (err, collection) => {\r\n            collection.update( \r\n                { _id: mongodb.ObjectId(req.params.idUser) },\r\n                {$push : {\r\n                        routines: {\r\n                            id_routine: new mongodb.ObjectId(),\r\n                            title: req.body.title,\r\n                            steps: req.body.steps\r\n                        }\r\n\r\n                    }\r\n                },\r\n                {},\r\n                (err) => {\r\n                    if(err) {\r\n                        res.status(500).json({'error': err});\r\n                    } else {\r\n                        res.status(200).json({'status': 'successful routine insertion'});\r\n                    }\r\n\r\n                }\r\n            )\r\n            if(err){\r\n                res.status(500).json({'error': err});\r\n            }\r\n        });\r\n    \r\n    \r\n    });\r\n    //Consulta Todas as Rotinas\r\n    application.route('/user/:idUser/routines').get((req, res) => {\r\n        global.conn.collection('users').find(\r\n            mongodb.ObjectId(req.params.idUser)\r\n        ).toArray(\r\n            (err, docs) => {\r\n                var routines = docs.routines\r\n                if (err) {\r\n                    res.status(500).json({ error: err });\r\n                } else {\r\n                    res.status(200).json({'user': docs});\r\n                }\r\n            \r\n            }\r\n        )\r\n    });\r\n\r\n} "]}